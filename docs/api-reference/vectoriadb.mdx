---
title: 'vectoriadb API'
description: 'Complete API reference for the vectoriadb package'
---

Complete API reference for the `vectoriadb` package.

## Installation

```bash
npm install vectoriadb
```

## VectoriaDB Class

Main vector database class.

### Constructor

```ts
new VectoriaDB(options?: VectoriaDBOptions)
```

### VectoriaDBOptions

```ts
interface VectoriaDBOptions {
  // Dimensions
  dimensions?: number;

  // Distance metric
  metric?: 'cosine' | 'euclidean' | 'dot';

  // Persistence
  persistence?: PersistenceAdapter;

  // Indexing
  indexType?: 'flat' | 'hnsw';
  hnswOptions?: HNSWOptions;

  // Embedding
  embedder?: Embedder;
}
```

| Property | Type | Default | Description |
|----------|------|---------|-------------|
| `dimensions` | `number` | Auto-detect | Vector dimensions |
| `metric` | `string` | `'cosine'` | Distance metric |
| `persistence` | `PersistenceAdapter` | In-memory | Storage adapter |
| `indexType` | `string` | `'flat'` | Index type |
| `embedder` | `Embedder` | `undefined` | Text embedding function |

### Methods

#### add(documents)

Add documents to the database.

```ts
async add(documents: Document | Document[]): Promise<string[]>
```

**Parameters:**
```ts
interface Document {
  id?: string;
  content: string;
  vector?: number[];
  metadata?: Record<string, unknown>;
}
```

**Returns:** Array of document IDs

**Example:**
```ts
const ids = await db.add([
  { content: 'First document', metadata: { category: 'a' } },
  { content: 'Second document', metadata: { category: 'b' } },
]);
```

#### search(query, options?)

Search for similar documents.

```ts
async search(query: string | number[], options?: SearchOptions): Promise<SearchResult[]>
```

**Parameters:**
```ts
interface SearchOptions {
  k?: number;           // Number of results (default: 10)
  filter?: FilterQuery; // Metadata filter
  threshold?: number;   // Minimum similarity score
}
```

**Returns:**
```ts
interface SearchResult {
  id: string;
  content: string;
  score: number;
  metadata?: Record<string, unknown>;
}
```

**Example:**
```ts
const results = await db.search('query text', {
  k: 5,
  filter: { category: 'a' },
  threshold: 0.7,
});
```

#### get(id)

Get a document by ID.

```ts
async get(id: string): Promise<Document | null>
```

#### delete(id)

Delete a document by ID.

```ts
async delete(id: string): Promise<boolean>
```

#### update(id, document)

Update a document.

```ts
async update(id: string, document: Partial<Document>): Promise<boolean>
```

#### count()

Get total document count.

```ts
async count(): Promise<number>
```

#### clear()

Remove all documents.

```ts
async clear(): Promise<void>
```

## Filter Queries

### Basic Filters

```ts
// Exact match
{ category: 'tech' }

// Multiple conditions (AND)
{ category: 'tech', status: 'published' }
```

### Comparison Operators

```ts
// Greater than
{ price: { $gt: 100 } }

// Greater than or equal
{ price: { $gte: 100 } }

// Less than
{ price: { $lt: 100 } }

// Less than or equal
{ price: { $lte: 100 } }

// Not equal
{ status: { $ne: 'draft' } }

// In array
{ category: { $in: ['tech', 'science'] } }

// Not in array
{ category: { $nin: ['spam', 'test'] } }
```

### Logical Operators

```ts
// OR
{ $or: [{ category: 'tech' }, { category: 'science' }] }

// AND (explicit)
{ $and: [{ price: { $gt: 10 } }, { price: { $lt: 100 } }] }

// NOT
{ $not: { status: 'draft' } }
```

### Array Operators

```ts
// Contains element
{ tags: { $contains: 'javascript' } }

// Contains all elements
{ tags: { $all: ['javascript', 'typescript'] } }
```

## Persistence Adapters

### Memory Adapter (Default)

```ts
import { VectoriaDB, MemoryAdapter } from 'vectoriadb';

const db = new VectoriaDB({
  persistence: new MemoryAdapter(),
});
```

### File Adapter

```ts
import { VectoriaDB, FileAdapter } from 'vectoriadb';

const db = new VectoriaDB({
  persistence: new FileAdapter({
    path: './data/vectors.json',
    autoSave: true,
    saveInterval: 30000, // 30 seconds
  }),
});
```

### Redis Adapter

```ts
import { VectoriaDB, RedisAdapter } from 'vectoriadb';
import Redis from 'ioredis';

const redis = new Redis(process.env.REDIS_URL);

const db = new VectoriaDB({
  persistence: new RedisAdapter({
    client: redis,
    prefix: 'vectoria:',
    ttl: 86400, // 24 hours
  }),
});
```

### Custom Adapter

```ts
import { PersistenceAdapter, Document } from 'vectoriadb';

class CustomAdapter implements PersistenceAdapter {
  async load(): Promise<Document[]> {
    // Load documents from storage
  }

  async save(documents: Document[]): Promise<void> {
    // Save documents to storage
  }

  async addOne(document: Document): Promise<void> {
    // Add single document
  }

  async deleteOne(id: string): Promise<void> {
    // Delete single document
  }
}
```

## HNSW Index

For large-scale datasets, use HNSW indexing.

```ts
import { VectoriaDB } from 'vectoriadb';

const db = new VectoriaDB({
  indexType: 'hnsw',
  hnswOptions: {
    M: 16,           // Max connections per node
    efConstruction: 200, // Build quality
    efSearch: 100,   // Search quality
  },
});
```

### HNSWOptions

```ts
interface HNSWOptions {
  M?: number;            // Max connections (default: 16)
  efConstruction?: number; // Build quality (default: 200)
  efSearch?: number;     // Search quality (default: 100)
}
```

## Embedders

### Custom Embedder

```ts
import { VectoriaDB, Embedder } from 'vectoriadb';

const embedder: Embedder = {
  async embed(text: string): Promise<number[]> {
    const response = await openai.embeddings.create({
      model: 'text-embedding-3-small',
      input: text,
    });
    return response.data[0].embedding;
  },
  dimensions: 1536,
};

const db = new VectoriaDB({ embedder });
```

### OpenAI Embedder

```ts
import { VectoriaDB, createOpenAIEmbedder } from 'vectoriadb';
import OpenAI from 'openai';

const openai = new OpenAI();
const embedder = createOpenAIEmbedder(openai, {
  model: 'text-embedding-3-small',
});

const db = new VectoriaDB({ embedder });
```

## TF-IDF Variant

Zero-dependency text search.

```ts
import { VectoriaTFIDF } from 'vectoriadb/tfidf';

const db = new VectoriaTFIDF();

await db.add([
  { content: 'JavaScript programming guide' },
  { content: 'TypeScript tutorial for beginners' },
]);

const results = await db.search('programming tutorial');
```

## Complete Example

```ts
import { VectoriaDB, FileAdapter, createOpenAIEmbedder } from 'vectoriadb';
import OpenAI from 'openai';

// Setup
const openai = new OpenAI();
const embedder = createOpenAIEmbedder(openai);

const db = new VectoriaDB({
  embedder,
  persistence: new FileAdapter({ path: './data/docs.json' }),
  indexType: 'hnsw',
  metric: 'cosine',
});

// Add documents
await db.add([
  {
    content: 'React is a JavaScript library for building user interfaces',
    metadata: { category: 'frontend', language: 'javascript' },
  },
  {
    content: 'Node.js is a JavaScript runtime for server-side development',
    metadata: { category: 'backend', language: 'javascript' },
  },
  {
    content: 'PostgreSQL is a powerful open-source relational database',
    metadata: { category: 'database', language: 'sql' },
  },
]);

// Search with filter
const results = await db.search('building web applications', {
  k: 5,
  filter: { language: 'javascript' },
  threshold: 0.5,
});

console.log(results);
// [
//   { id: '...', content: 'React is...', score: 0.89, metadata: {...} },
//   { id: '...', content: 'Node.js is...', score: 0.72, metadata: {...} },
// ]

// Get document
const doc = await db.get(results[0].id);
if (!doc) {
  throw new Error('Document not found');
}

// Update document
await db.update(results[0].id, {
  metadata: { ...doc.metadata, popular: true },
});

// Delete document
await db.delete(results[0].id);

// Count
const count = await db.count();
console.log(`Total documents: ${count}`);
```

## Types

### Document

```ts
interface Document {
  id?: string;
  content: string;
  vector?: number[];
  metadata?: Record<string, unknown>;
}
```

### SearchResult

```ts
interface SearchResult {
  id: string;
  content: string;
  score: number;
  metadata?: Record<string, unknown>;
  vector?: number[];
}
```

### Embedder

```ts
interface Embedder {
  embed(text: string): Promise<number[]>;
  dimensions: number;
}
```

### PersistenceAdapter

```ts
interface PersistenceAdapter {
  load(): Promise<Document[]>;
  save(documents: Document[]): Promise<void>;
  addOne?(document: Document): Promise<void>;
  deleteOne?(id: string): Promise<void>;
  updateOne?(id: string, document: Partial<Document>): Promise<void>;
}
```

## Related

- [Overview](/core-libraries/vectoriadb/overview) - Feature overview
- [Search](/core-libraries/vectoriadb/search) - Search techniques
- [HNSW](/core-libraries/vectoriadb/hnsw) - HNSW indexing
